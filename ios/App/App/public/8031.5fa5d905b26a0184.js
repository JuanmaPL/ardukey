"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8031],{8031:(y,m,a)=>{a.r(m),a.d(m,{LoginPageModule:()=>S});var I=a(6895),i=a(433),o=a(8779),u=a(1194),g=a(655);const b=(0,a(7423).fo)("App",{web:()=>a.e(4477).then(a.bind(a,4477)).then(n=>new n.AppWeb)});var e=a(4650),p=a(5970),h=a(1205),f=a(1343);let C=(()=>{class n{constructor(t,r,l,c,d){this.modalCtrl=t,this.fb=r,this.alert=l,this.auth=c,this.firestoreService=d,this.registerForm={},this.registro={}}ngOnInit(){this.registerForm=this.fb.group({mail:["",i.Validators.required],password:["",i.Validators.required],confirm:["",i.Validators.required]})}register(){const t={email:this.registerForm.controls.mail.value,password:this.registerForm.controls.password.value};"VALID"==this.registerForm.status?t.password===this.registerForm.controls.confirm.value?(this.registro={EMAIL:"",ROL:"user",UID:""},this.auth.createUserWithEmailAndPassword(t.email,t.password).then(r=>{var l,c;this.registro={EMAIL:null===(l=r.user)||void 0===l?void 0:l.email,ROL:"user",UID:null===(c=r.user)||void 0===c?void 0:c.uid},this.alert.registerAlert("Success","El usuario a sido creado correctamente"),this.firestoreService.insertar("usuarios",this.registro).then(()=>{console.log("Tarea creada correctamente!")},d=>{console.error(d)}),this.cerrar(),console.log(r)}).catch(r=>{console.log(r),this.alert.registerAlert("\xa1Error!",this.error(r))})):this.alert.registerAlert("\xa1Error!","Las contrase\xf1as no coinciden"):this.alert.registerAlert("\xa1Error!","Hay alg\xfan campo vac\xedo")}cerrar(){this.modalCtrl.dismiss()}error(t){return"FirebaseError: Firebase: A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred. (auth/network-request-failed)."==t&&(t="Fallo de red, error en la conexi\xf3n"),"FirebaseError: Firebase: The email address is badly formatted. (auth/invalid-email)."==t&&(t="El mail no es correcto"),"FirebaseError: Firebase: Password should be at least 6 characters (auth/weak-password)."==t&&(t="La password no cumple la regla de al menos seis car\xe1cteres"),t}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(o.ModalController),e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(p.c),e.\u0275\u0275directiveInject(h.zQ),e.\u0275\u0275directiveInject(f.C))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-register"]],decls:28,vars:2,consts:[[1,"ion-no-border",3,"translucent"],["slot","end"],["slot","end","shape","round","color","danger","fill","outline","size","small",3,"click"],["shape","round","name","log-out-outline"],["color","primary"],[3,"formGroup"],[1,"input-container","ion-justify-content-center","ion-align-items-center"],[1,"label-input","label-2","ion-text-end"],[1,"ipt"],["formControlName","mail","placeholder","Correo electr\xf3nico"],[1,"label-input","label-3","ion-text-end"],["type","password","formControlName","password","placeholder","* * * * *"],[1,"label-input","label-4","ion-text-end"],["type","password","formControlName","confirm","placeholder"," * * * * *"],["shape","round","expand","block",1,"register","ion-text-uppercase",3,"click"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),e.\u0275\u0275listener("click",function(){return r.cerrar()}),e.\u0275\u0275element(4,"ion-icon",3),e.\u0275\u0275text(5,"Cerrar "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"ion-title",4),e.\u0275\u0275text(7," Registrar Usuario"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(8,"ion-content")(9,"form",5)(10,"ion-row",6)(11,"span",7),e.\u0275\u0275text(12,"Email"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"ion-item",8),e.\u0275\u0275element(14,"ion-input",9),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"ion-row",6)(16,"span",10),e.\u0275\u0275text(17,"Contrase\xf1a"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"ion-item",8),e.\u0275\u0275element(19,"ion-input",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"ion-row",6)(21,"span",12),e.\u0275\u0275text(22,"Confirmar Contrase\xf1a"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"ion-item",8),e.\u0275\u0275element(24,"ion-input",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(25,"ion-row",6)(26,"ion-button",14),e.\u0275\u0275listener("click",function(){return r.register()}),e.\u0275\u0275text(27,"Create account "),e.\u0275\u0275elementEnd()()()()),2&t&&(e.\u0275\u0275property("translucent",!0),e.\u0275\u0275advance(9),e.\u0275\u0275property("formGroup",r.registerForm))},dependencies:[o.IonButton,o.IonButtons,o.IonContent,o.IonHeader,o.IonIcon,o.IonInput,o.IonItem,o.IonRow,o.IonTitle,o.IonToolbar,o.TextValueAccessor,i.\u0275NgNoValidate,i.NgControlStatus,i.NgControlStatusGroup,i.FormGroupDirective,i.FormControlName]}),n})();const F=[{path:"",component:(()=>{class n{constructor(t,r,l,c,d,w){this.auth=t,this.fb=r,this.alert=l,this.firestoreService=c,this.modalCtrl=d,this.router=w,this.coleccionUsuarios=[{id:"",data:{}}],this.loginForm={}}ionViewDidLeave(){}ngOnInit(){this.loginForm=this.fb.group({email:["",i.Validators.required],password:["",i.Validators.required]})}login(){this.auth.signInWithEmailAndPassword(this.loginForm.controls.email.value,this.loginForm.controls.password.value).then(()=>{this.loginForm.reset(),this.alert.registerAlert("Alerta","Correctamente logeado")}).catch(t=>(0,g.mG)(this,void 0,void 0,function*(){this.alert.registerAlert("Alerta",this.error(t))})),this.crearRol()}crearRol(){this.auth.authState.subscribe(t=>{null==t?localStorage.setItem("uid","no existe"):(localStorage.setItem("uid",t.uid),console.log("CrearlRol Uid "+localStorage.getItem("uid")))}),console.log("crear rol"+localStorage.getItem("uid")),console.log("dentro de obtener Lista  "+localStorage.getItem("uid")),this.firestoreService.consultar("usuarios").subscribe(t=>{this.coleccionUsuarios=[],console.log("dentro de resultadoConsulta"),t.forEach(r=>{this.coleccionUsuarios.push({id:r.payload.doc.id,data:r.payload.doc.data()})}),this.coleccionUsuarios.forEach(r=>{r.data.UID===localStorage.getItem("uid")&&localStorage.setItem("rol",r.data.ROL)})})}logout(){this.auth.signOut(),localStorage.setItem("rol",""),this.router.navigate(["tabs"],{replaceUrl:!0}),localStorage.setItem("uid","noexiste")}register(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalCtrl.create({component:C})).present()})}cerrar(){b.exitApp()}error(t){return"FirebaseError: Firebase: The email address is badly formatted. (auth/invalid-email)."==t&&(t="El campo mail no est\xe1 correctamente formado"),"FirebaseError: Firebase: An internal AuthError has occurred. (auth/internal-error)."==t&&(t="No se ha introducido ninguna contrase\xf1a"),"FirebaseError: Firebase: There is no user record corresponding to this identifier. The user may have been deleted. (auth/user-not-found)."==t&&(t="No se ha encontrado el usuario o \xe9ste ha sido eliminado"),"FirebaseError: Firebase: A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred. (auth/network-request-failed)."==t&&(t="Error de red hay un fallo en la conexi\xf3n"),t}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(h.zQ),e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(p.c),e.\u0275\u0275directiveInject(f.C),e.\u0275\u0275directiveInject(o.ModalController),e.\u0275\u0275directiveInject(u.F0))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-login"]],decls:29,vars:1,consts:[[1,"logo-container","ion-justify-content-center","ion-align-items-center"],["src","../../assets/img/cerradura.png","alt",""],[3,"formGroup"],[1,"input-container","ion-justify-content-center","ion-align-items-center"],["lines","none",1,"ipt"],["formControlName","email","placeholder","Email"],["name","person","slot","start"],["formControlName","password","type","password","placeholder","Pass* * * * * *"],["name","lock-closed","slot","start"],["fill","outline","shape","round",1,"ion-text-uppercase",3,"click"],["shape","round","fill","outline",1,"register","ion-text-uppercase",3,"click"],["fill","outline","shape","round",3,"click"],["slot","start","name","log-out-outline"],["offset","3"],[1,"label"],["horizontal","end","vertical","bottom","position","fixed"],[3,"click"],["name","exit"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"ion-content")(1,"ion-row",0),e.\u0275\u0275element(2,"ion-img",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"form",2)(4,"ion-row",3)(5,"ion-item",4),e.\u0275\u0275element(6,"ion-input",5)(7,"ion-icon",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"ion-row",3)(9,"ion-item",4),e.\u0275\u0275element(10,"ion-input",7)(11,"ion-icon",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"ion-row",3)(13,"ion-button",9),e.\u0275\u0275listener("click",function(){return r.login()}),e.\u0275\u0275text(14,"login"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"ion-row",3)(16,"ion-button",10),e.\u0275\u0275listener("click",function(){return r.register()}),e.\u0275\u0275text(17,"Create account "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"ion-row",3)(19,"ion-button",11),e.\u0275\u0275listener("click",function(){return r.logout()}),e.\u0275\u0275element(20,"ion-icon",12),e.\u0275\u0275text(21,"logout"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"ion-grid")(23,"ion-col",13)(24,"ion-label",14),e.\u0275\u0275text(25," ALOJAMIENTO"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(26,"ion-fab",15)(27,"ion-fab-button",16),e.\u0275\u0275listener("click",function(){return r.cerrar()}),e.\u0275\u0275element(28,"ion-icon",17),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",r.loginForm))},dependencies:[i.\u0275NgNoValidate,i.NgControlStatus,i.NgControlStatusGroup,o.IonButton,o.IonCol,o.IonContent,o.IonFab,o.IonFabButton,o.IonGrid,o.IonIcon,o.IonImg,o.IonInput,o.IonItem,o.IonLabel,o.IonRow,o.TextValueAccessor,i.FormGroupDirective,i.FormControlName],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}ion-grid[_ngcontent-%COMP%]{--ion-grid-padding: 500px;--ion-grid-padding-xs: 40px;--ion-grid-padding-sm: 20px;--ion-grid-padding-md: 20px;--ion-grid-padding-lg: 20px;--ion-grid-padding-xl: 20px;--ion-grid-column-padding: 10px;--ion-grid-column-padding-xs: 30px;--ion-grid-column-padding-sm: 30px;--ion-grid-column-padding-md: 30px;--ion-grid-column-padding-lg: 30px;--ion-grid-column-padding-xl: 30px}"]}),n})()}];let E=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[u.Bz.forChild(F),u.Bz]}),n})();var x=a(5642);let S=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[I.CommonModule,i.FormsModule,o.IonicModule,i.ReactiveFormsModule,E,x.K]}),n})()}}]);